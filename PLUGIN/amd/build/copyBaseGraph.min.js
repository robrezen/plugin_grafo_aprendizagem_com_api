define(["jquery","core/str","core/notification","core/log","core/modal_factory"],function(e,o,n,t,r){return{init(){t.debug("copyBaseGraph init"),e("#id_copybasegraphbtn").on("click",r=>{r.preventDefault(),t.info(r),t.info("copybasegraphbtn clicked");let i=e("#id_selecteduser").val();i?o.get_string("confirm_copy_base_graph","mod_learninggraph").then(e=>{confirm(e)&&(window.location.href=M.cfg.wwwroot+"/mod/learninggraph/copy_base_graph.php?cmid="+M.cfg.contextInstanceId+"&userid="+i)}):n.alert(o.get_string("error"),o.get_string("nouserselected","mod_learninggraph"),"error")});var i=document.querySelector("[data-error=existing_graphs]");if(t.debug(i),i){var a=JSON.parse(i.innerText);o.get_strings([{key:"existing_graphs_title",component:"mod_learninggraph"},{key:"existing_graphs_message",component:"mod_learninggraph"},{key:"yes",component:"moodle"},{key:"no",component:"moodle"}]).done(function(e){r.create({type:r.types.SAVE_CANCEL,title:e[0],body:e[1],preShowCallback:function(o){o.getRoot().find(".modal-body").html(e[1]+"<br>"+a.join(", "))}}).done(function(e){e.getRoot().on(ModalEvents.save,function(){document.querySelector('input[name="use_existing_graphs"]').value=1,e.hide(),document.querySelector("form").submit()}),e.getRoot().on(ModalEvents.cancel,function(){e.hide()}),e.show()})})}}}});